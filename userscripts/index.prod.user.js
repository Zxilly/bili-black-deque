// @license https://opensource.org/licenses/MIT
(()=>{"use strict";var t={204:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function l(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,l)}c((i=i.apply(t,e||[])).next())})},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.getBlackListCnt=void 0;let r=o(n(467));e.getBlackListCnt=function(){return i(this,void 0,void 0,function*(){let t=(yield r.default.get("https://api.bilibili.com/x/relation/blacks",{withCredentials:!0})).data;return t.data.total})}},166:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function l(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,l)}c((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});let o=n(224),r=n(204);document.addEventListener("keydown",t=>{t.ctrlKey&&"b"===t.key&&function(){i(this,void 0,void 0,function*(){let t=yield(0,r.getBlackListCnt)(),e=window.prompt(`现在黑名单有 ${t}人，想移除：`);if(null===e){alert("必须输入一个整数");return}let n=Number.parseInt(e);if(Number.isNaN(n)){alert(`${e} 不能被解释为合法整数`);return}if(n<=0&&alert("数字必须大于 0"),t<n){alert(`当前黑名单中的人数 ${t} 少于 ${n}`);return}yield(0,o.popBlack)(n,t)})}()})},224:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function l(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,l)}c((i=i.apply(t,e||[])).next())})},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.popBlack=void 0;let r=o(n(467)),a=n(204),l=document.cookie.split("; ").find(t=>t.startsWith("bili_jct")).split("=")[1];e.popBlack=function(t,e){return i(this,void 0,void 0,function*(){let n=Math.ceil(e/50),i=[];for(let e=n;e>0;e--){let n=(yield r.default.get("https://api.bilibili.com/x/relation/blacks",{params:{ps:20,pn:e},withCredentials:!0})).data,o=n.data.list;for(let e of(o.reverse(),o)){let n=e.mid;if(i.push(n),i.length>=t)break}if(i.length>=t)break}for(let t of(console.log(JSON.stringify(i)),console.log("收集完成，准备解除"),console.groupCollapsed("解除请求细节"),i)){let e=new URLSearchParams;e.append("fid",t),e.append("csrf",l),e.append("act","6"),e.append("re_src","116");let n=(yield r.default.post("https://api.bilibili.com/x/relation/modify",e,{withCredentials:!0})).data;console.debug(JSON.stringify(n))}console.groupEnd();let o=yield(0,a.getBlackListCnt)();alert(`处理完成，当前黑名单有 ${o} 人`)})}},467:t=>{t.exports=axios}},e={};!function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}(166)})();